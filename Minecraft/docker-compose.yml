services:
  minecraft:
    image: minecraft-server:latest
    container_name: minecraft
    environment:
      - EULA=TRUE
      - PUID=1000
      - PGID=1000
    ports:
      - "25565:25565"
    user: "minecraft:minecraft"
    volumes:
      - server:/opt/minecraft
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure 
      resources:
        limits:
          memory: 3G
    # Comment out when using swarm
    # restart: unless-stopped
volumes:
  server:
    # When using swarm with docker compose. If not, comment out 
    external: true
